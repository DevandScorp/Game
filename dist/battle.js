!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var r=function(){function e(t,n,i,r,s,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pos=n,this.size=i,this.speed="number"==typeof r?r:0,this.frames=s,this.index=0,this.url=t,this.dir=o||"horizontal",this.once=a}var t,n,r;return t=e,(n=[{key:"update",value:function(e){this.index+=this.speed*e}},{key:"render",value:function(e,t){var n;if(this.speed>0){var i=this.frames.length,r=Math.floor(this.index);if(n=this.frames[r%i],this.once&&r>=i)return void(this.done=!0)}else n=0;var s=this.pos[0];s+=n*this.size[0],e.drawImage(t.get(this.url),s,this.pos[1],this.size[0],this.size[1],0,0,this.size[0],this.size[1])}}])&&i(t.prototype,n),r&&i(t,r),e}();function s(e){var t=new(window.AudioContext||window.webkitAudioContext),n=t.createBufferSource();fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){t.decodeAudioData(e,function(e){n.buffer=e,n.connect(t.destination)})}).then(function(){return n.start(0)}).catch(function(e){return console.log(e)})}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resources=i,this.canvas=t,this.ctx=n,this.bulletSpeed=500,this.bullets=[],this.enemy=e.getEnemySprites(),this.player={pos:[0,0],sprite:new r("img/knight.png",[0,0],[256,256],10,[0,1,2,3,4,5,6])},this.isDamaged=!1,this.isHealed=!1,this.damage={pos:[0,0],sprite:new r("img/explosion.png",[0,0],[256,256],15,[0,1,2,3,4,5,6])},this.heal={pos:[0,0],sprite:new r("img/heal.png",[0,0],[256,256],10,[0,1,2,3,4,5,6])},this.orkHealth=100,this.heroHealth=100}var t,n,i;return t=e,i=[{key:"getEnemySprites",value:function(){var t={pos:[0,0],sprite:new r("img/orkSprite.png",[220*e.getRandomInt(0,3),935],[220,240])},n={pos:[0,0],sprite:new r("img/orkSprite.png",[85*e.getRandomInt(0,3),0],[85,120])},i={pos:[0,0],sprite:new r("img/orkSprite.png",[85*e.getRandomInt(0,3),120],[85,120])},s={pos:[0,0],sprite:new r("img/orkSprite.png",[219*e.getRandomInt(0,3),240],[219,282])},o={pos:[0,0],sprite:new r("img/orkSprite.png",[165*e.getRandomInt(0,3),720],[165,210])};return[i,n,s,t,{pos:[0,0],sprite:new r("img/orkSprite.png",[220*e.getRandomInt(0,3),525],[220,195])},o]}},{key:"getRandomInt",value:function(e,t){return Math.floor(Math.random()*(t-e))+e}}],(n=[{key:"makeShot",value:function(){var e=this,t=this.player.pos[0]+this.player.sprite.size[0]/2,n=this.player.pos[1];this.player.sprite=new r("img/knightAttack.png",[0,0],[256,256],15,[0,1,2,3,4,5]),setTimeout(function(){e.player.sprite=new r("img/knight.png",[0,0],[256,256],10,[0,1,2,3,4,5]),e.bullets.push({pos:[t,n],sprite:new r("img/fire.png",[0,0],[256,256],10,[0,1,2,3,4,5])})},300),s("../game/sounds/iceball.wav")}},{key:"attackHero",value:function(){var e=this;this.heroHealth-=25,console.log(this.heroHealth),this.isDamaged=!0,this.player.sprite=new r("img/damage.png",[0,0],[256,256],15,[0,1,2,3,4,5]),setTimeout(function(){e.player.sprite=new r("img/knight.png",[0,0],[256,256],10,[0,1,2,3,4,5]),e.isDamaged=!1},300),s("../game/sounds/qubodup-BangShort.ogg")}},{key:"healHero",value:function(){var e=this;100!==this.heroHealth&&(this.heroHealth+=25,console.log(this.heroHealth)),this.isHealed=!0,setTimeout(function(){e.isHealed=!1},1e3),s("../game/sounds/blessing.ogg")}},{key:"updateEntities",value:function(e){this.player.sprite.update(e),this.enemy.forEach(function(t){return t.sprite.update(e)}),this.heal.sprite.update(e),this.damage.sprite.update(e);for(var t=0;t<this.bullets.length;t+=1)this.bullets[t].pos[0]+=this.bulletSpeed*e,this.bullets[t].sprite.update(e),this.bullets[t].pos[0]>=this.enemy[2].pos[0]&&(this.orkHealth-=25,console.log(this.orkHealth),this.bullets.splice(t,1),t-=1);this.heroHealth||(alert("Lose"),this.reset()),this.orkHealth||(alert("Win"),this.reset())}},{key:"renderEntity",value:function(e){this.ctx.save(),this.ctx.translate(e.pos[0],e.pos[1]),e.sprite.render(this.ctx,this.resources),this.ctx.restore()}},{key:"render",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderEntity(this.player),this.isDamaged&&this.renderEntity(this.damage),this.isHealed&&this.renderEntity(this.heal),this.renderEntities(this.enemy),this.renderEntities(this.bullets)}},{key:"renderEntities",value:function(e){for(var t=0;t<e.length;t+=1)this.renderEntity(e[t])}},{key:"reset",value:function(){var t;this.heroHealth=100,this.orkHealth=100,this.bullets=[],this.player.pos=[25,this.canvas.height/2-this.player.sprite.size[0]/2],this.damage.pos=[25,this.canvas.height/2-this.player.sprite.size[0]/2],this.heal.pos=[25,this.canvas.height/2-this.player.sprite.size[0]/2],this.enemy.splice(0,this.enemy.length),(t=this.enemy).push.apply(t,o(e.getEnemySprites()));var n=this.enemy[3].sprite.size[0],i=this.enemy[3].sprite.size[1],r=this.canvas.width,s=this.canvas.height;this.enemy[3].pos=[r-n-200,s/2-i/2],this.enemy[1].pos=[r-n-180,s/2-i/2+180],this.enemy[0].pos=[r-n-90,s/2-i/2+180],this.enemy[2].pos=[r-n-360,s/2-i/2+20],this.enemy[5].pos=[r-n-45,s/2-i/2+40],this.enemy[4].pos=[r-n-210,s/2-i/2-80]}}])&&a(t.prototype,n),i&&a(t,i),e}(),u={},l=[];function p(){var e=!0;return Object.keys(u).forEach(function(t){u.hasOwnProperty(t)&&!u[t]&&(e=!1)}),e}function c(e){if(u[e])return u[e];var t=new Image;t.onload=function(){u[e]=t,p()&&l.forEach(function(e){e()})},u[e]=!1,t.src=e}var f={load:function(e){e instanceof Array?e.forEach(function(e){c(e)}):c(e)},get:function(e){return u[e]},onReady:function(e){l.push(e)},isReady:p},d=document.createElement("canvas");d.width=window.innerWidth,d.height=window.innerHeight,document.body.appendChild(d);var g=d.getContext("2d"),m=new h(d,g,f),y=0;function v(){var e=Date.now(),t=(e-y)/1e3;m.updateEntities(t),m.render(),y=e,requestAnimationFrame(v)}f.load(["img/heal.png","img/explosion.png","img/damage.png","img/knight.png","img/fire.png","img/knightAttack.png","img/orkSprite.png"]),f.onReady(function(){m.reset(),y=Date.now(),v()}),window.addEventListener("click",function(){m.makeShot()},!1),window.addEventListener("contextmenu",function(e){e.preventDefault(),m.attackHero()},!1),window.addEventListener("keydown",function(e){"Space"===e.code&&m.healHero()},!1)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NjcmVlbi9nYW1lL2pzL3Nwcml0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc2NyZWVuL2dhbWUvanMvbXVzaWNIYW5kbGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9zY3JlZW4vZ2FtZS9qcy9maWdodEludGVyZmFjZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc2NyZWVuL2dhbWUvanMvcmVzb3VyY2VIYW5kbGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9zY3JlZW4vZ2FtZS9qcy9hcHAuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJTcHJpdGUiLCJ1cmwiLCJwb3MiLCJzaXplIiwic3BlZWQiLCJmcmFtZXMiLCJkaXIiLCJvbmNlIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsImluZGV4IiwiZHQiLCJ0eCIsInJlc291cmNlcyIsImZyYW1lIiwibWF4IiwibGVuZ3RoIiwiaWR4IiwiTWF0aCIsImZsb29yIiwiZG9uZSIsIngiLCJkcmF3SW1hZ2UiLCJtYWtlQVNvdW5kIiwicGF0aCIsImF1ZGlvQ3R4Iiwid2luZG93IiwiQXVkaW9Db250ZXh0Iiwid2Via2l0QXVkaW9Db250ZXh0Iiwic291cmNlIiwiY3JlYXRlQnVmZmVyU291cmNlIiwiZmV0Y2giLCJ0aGVuIiwicmVzcG9uc2UiLCJhcnJheUJ1ZmZlciIsImJ1ZmZlciIsImRlY29kZUF1ZGlvRGF0YSIsImRlY29kZWREYXRhIiwiY29ubmVjdCIsImRlc3RpbmF0aW9uIiwic3RhcnQiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsIkZpZ2h0SW50ZXJmYWNlIiwiY2FudmFzIiwiY3R4IiwiZmlnaHRJbnRlcmZhY2VfY2xhc3NDYWxsQ2hlY2siLCJidWxsZXRTcGVlZCIsImJ1bGxldHMiLCJlbmVteSIsImdldEVuZW15U3ByaXRlcyIsInBsYXllciIsInNwcml0ZSIsImlzRGFtYWdlZCIsImlzSGVhbGVkIiwiZGFtYWdlIiwiaGVhbCIsIm9ya0hlYWx0aCIsImhlcm9IZWFsdGgiLCJvcmtCb2R5IiwiZ2V0UmFuZG9tSW50IiwibGVmdExlZyIsInJpZ2h0TGVnIiwicmlnaHRIYW5kIiwibGVmdEhhbmQiLCJtaW4iLCJyYW5kb20iLCJfdGhpcyIsInkiLCJzZXRUaW1lb3V0IiwicHVzaCIsIl90aGlzMiIsIl90aGlzMyIsInVwZGF0ZSIsImZvckVhY2giLCJhIiwic3BsaWNlIiwiYWxlcnQiLCJyZXNldCIsImVudGl0eSIsInNhdmUiLCJ0cmFuc2xhdGUiLCJyZW5kZXIiLCJyZXN0b3JlIiwiY2xlYXJSZWN0Iiwid2lkdGgiLCJoZWlnaHQiLCJyZW5kZXJFbnRpdHkiLCJyZW5kZXJFbnRpdGllcyIsImxpc3QiLCJfdGhpcyRlbmVteSIsImFwcGx5IiwiX3RvQ29uc3VtYWJsZUFycmF5IiwiYm9keVNpemVYIiwiYm9keVNpemVZIiwiY2FudmFzV2lkdGgiLCJjYW52YXNIZWlnaHQiLCJyZXNvdXJjZUNhY2hlIiwicmVhZHlDYWxsYmFja3MiLCJpc1JlYWR5IiwicmVhZHkiLCJrZXlzIiwiayIsImxvYWRVUkwiLCJpbWciLCJJbWFnZSIsIm9ubG9hZCIsImZ1bmMiLCJzcmMiLCJsb2FkIiwidXJsT3JBcnIiLCJBcnJheSIsIm9uUmVhZHkiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJnZXRDb250ZXh0IiwiZ2FtZSIsInJlc291cmNlSGFuZGxlciIsImxhc3RUaW1lIiwibWFpbiIsIm5vdyIsIkRhdGUiLCJ1cGRhdGVFbnRpdGllcyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJtYWtlU2hvdCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImF0dGFja0hlcm8iLCJjb2RlIiwiaGVhbEhlcm8iXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxFQUFBLENBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxZQUFBLENBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJCLEVBQUFzQixFQUFBLFNBQUFELEVBQUFFLEdBRUEsR0FEQSxFQUFBQSxJQUFBRixFQUFBckIsRUFBQXFCLElBQ0EsRUFBQUUsRUFBQSxPQUFBRixFQUNBLEtBQUFFLEdBQUEsaUJBQUFGLFFBQUFHLFdBQUEsT0FBQUgsRUFDQSxJ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R0FDbkIsVUFBWEEsRUFBRUcsTUFBb0JiLEVBQUtjLGFBQzlCIiwiZmlsZSI6ImJhdHRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNwcml0ZSB7XG4gIGNvbnN0cnVjdG9yKHVybCwgcG9zLCBzaXplLCBzcGVlZCwgZnJhbWVzLCBkaXIsIG9uY2UpIHtcbiAgICB0aGlzLnBvcyA9IHBvcztcbiAgICB0aGlzLnNpemUgPSBzaXplO1xuICAgIHRoaXMuc3BlZWQgPSB0eXBlb2Ygc3BlZWQgPT09ICdudW1iZXInID8gc3BlZWQgOiAwO1xuICAgIHRoaXMuZnJhbWVzID0gZnJhbWVzO1xuICAgIHRoaXMuaW5kZXggPSAwO1xuICAgIHRoaXMudXJsID0gdXJsO1xuICAgIHRoaXMuZGlyID0gZGlyIHx8ICdob3Jpem9udGFsJztcbiAgICB0aGlzLm9uY2UgPSBvbmNlO1xuICB9XG5cbiAgdXBkYXRlKGR0KSB7XG4gICAgdGhpcy5pbmRleCArPSB0aGlzLnNwZWVkICogZHQ7XG4gIH1cblxuICByZW5kZXIodHgsIHJlc291cmNlcykge1xuICAgIGxldCBmcmFtZTtcblxuICAgIGlmICh0aGlzLnNwZWVkID4gMCkge1xuICAgICAgY29uc3QgbWF4ID0gdGhpcy5mcmFtZXMubGVuZ3RoO1xuICAgICAgY29uc3QgaWR4ID0gTWF0aC5mbG9vcih0aGlzLmluZGV4KTtcbiAgICAgIGZyYW1lID0gdGhpcy5mcmFtZXNbaWR4ICUgbWF4XTtcblxuICAgICAgaWYgKHRoaXMub25jZSAmJiBpZHggPj0gbWF4KSB7XG4gICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZnJhbWUgPSAwO1xuICAgIH1cbiAgICBsZXQgeCA9IHRoaXMucG9zWzBdO1xuICAgIHggKz0gZnJhbWUgKiB0aGlzLnNpemVbMF07XG4gICAgdHguZHJhd0ltYWdlKHJlc291cmNlcy5nZXQodGhpcy51cmwpLFxuICAgICAgeCwgdGhpcy5wb3NbMV0sXG4gICAgICB0aGlzLnNpemVbMF0sIHRoaXMuc2l6ZVsxXSxcbiAgICAgIDAsIDAsXG4gICAgICB0aGlzLnNpemVbMF0sIHRoaXMuc2l6ZVsxXSk7XG4gIH1cbn1cbiIsIi8qKiBMb2FkIGFuZCBwbGF5IG11c2ljIGZpbGUgKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1ha2VBU291bmQocGF0aCkge1xuICBjb25zdCBhdWRpb0N0eCA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KSgpO1xuICBjb25zdCBzb3VyY2UgPSBhdWRpb0N0eC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcbiAgZmV0Y2gocGF0aClcbiAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5hcnJheUJ1ZmZlcigpKVxuICAgIC50aGVuKChidWZmZXIpID0+IHtcbiAgICAgIGF1ZGlvQ3R4LmRlY29kZUF1ZGlvRGF0YShidWZmZXIsIChkZWNvZGVkRGF0YSkgPT4ge1xuICAgICAgICBzb3VyY2UuYnVmZmVyID0gZGVjb2RlZERhdGE7XG4gICAgICAgIHNvdXJjZS5jb25uZWN0KGF1ZGlvQ3R4LmRlc3RpbmF0aW9uKTtcbiAgICAgIH0pO1xuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4gc291cmNlLnN0YXJ0KDApKVxuICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmxvZyhlcnJvcikpO1xufVxuIiwiaW1wb3J0IFNwcml0ZSBmcm9tICcuL3Nwcml0ZSc7XG5pbXBvcnQgbWFrZUFTb3VuZCBmcm9tICcuL211c2ljSGFuZGxlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpZ2h0SW50ZXJmYWNlIHtcbiAgY29uc3RydWN0b3IoY2FudmFzLCBjdHgsIHJlc291cmNlcykge1xuICAgIHRoaXMucmVzb3VyY2VzID0gcmVzb3VyY2VzO1xuICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xuICAgIHRoaXMuY3R4ID0gY3R4O1xuICAgIHRoaXMuYnVsbGV0U3BlZWQgPSA1MDA7XG4gICAgdGhpcy5idWxsZXRzID0gW107XG4gICAgdGhpcy5lbmVteSA9IEZpZ2h0SW50ZXJmYWNlLmdldEVuZW15U3ByaXRlcygpO1xuICAgIHRoaXMucGxheWVyID0ge1xuICAgICAgcG9zOiBbMCwgMF0sXG4gICAgICBzcHJpdGU6IG5ldyBTcHJpdGUoJ2ltZy9rbmlnaHQucG5nJywgWzAsIDBdLCBbMjU2LCAyNTZdLCAxMCwgWzAsIDEsIDIsIDMsIDQsIDUsIDZdKSxcbiAgICB9O1xuICAgIHRoaXMuaXNEYW1hZ2VkID0gZmFsc2U7XG4gICAgdGhpcy5pc0hlYWxlZCA9IGZhbHNlO1xuICAgIHRoaXMuZGFtYWdlID0ge1xuICAgICAgcG9zOiBbMCwgMF0sXG4gICAgICBzcHJpdGU6IG5ldyBTcHJpdGUoJ2ltZy9leHBsb3Npb24ucG5nJywgWzAsIDBdLCBbMjU2LCAyNTZdLCAxNSwgWzAsIDEsIDIsIDMsIDQsIDUsIDZdKSxcbiAgICB9O1xuICAgIHRoaXMuaGVhbCA9IHtcbiAgICAgIHBvczogWzAsIDBdLFxuICAgICAgc3ByaXRlOiBuZXcgU3ByaXRlKCdpbWcvaGVhbC5wbmcnLCBbMCwgMF0sIFsyNTYsIDI1Nl0sIDEwLCBbMCwgMSwgMiwgMywgNCwgNSwgNl0pLFxuICAgIH07XG4gICAgdGhpcy5vcmtIZWFsdGggPSAxMDA7XG4gICAgdGhpcy5oZXJvSGVhbHRoID0gMTAwO1xuICB9XG5cbiAgc3RhdGljIGdldEVuZW15U3ByaXRlcygpIHtcbiAgICBjb25zdCBvcmtTcHJpdGVMb2NhdGlvbiA9ICdpbWcvb3JrU3ByaXRlLnBuZyc7XG4gICAgY29uc3Qgb3JrQm9keSA9IHtcbiAgICAgIHBvczogWzAsIDBdLFxuICAgICAgc3ByaXRlOiBuZXcgU3ByaXRlKG9ya1Nwcml0ZUxvY2F0aW9uLCBbMjIwICogRmlnaHRJbnRlcmZhY2UuZ2V0UmFuZG9tSW50KDAsIDMpLCA5MzVdLCBbMjIwLCAyNDBdKSxcbiAgICB9O1xuICAgIGNvbnN0IGxlZnRMZWcgPSB7XG4gICAgICBwb3M6IFswLCAwXSxcbiAgICAgIHNwcml0ZTogbmV3IFNwcml0ZShvcmtTcHJpdGVMb2NhdGlvbiwgWzg1ICogRmlnaHRJbnRlcmZhY2UuZ2V0UmFuZG9tSW50KDAsIDMpLCAwXSwgWzg1LCAxMjBdKSxcbiAgICB9O1xuICAgIGNvbnN0IHJpZ2h0TGVnID0ge1xuICAgICAgcG9zOiBbMCwgMF0sXG4gICAgICBzcHJpdGU6IG5ldyBTcHJpdGUob3JrU3ByaXRlTG9jYXRpb24sIFs4NSAqIEZpZ2h0SW50ZXJmYWNlLmdldFJhbmRvbUludCgwLCAzKSwgMTIwXSwgWzg1LCAxMjBdKSxcbiAgICB9O1xuICAgIGNvbnN0IHJpZ2h0SGFuZCA9IHtcbiAgICAgIHBvczogWzAsIDBdLFxuICAgICAgc3ByaXRlOiBuZXcgU3ByaXRlKG9ya1Nwcml0ZUxvY2F0aW9uLCBbMjE5ICogRmlnaHRJbnRlcmZhY2UuZ2V0UmFuZG9tSW50KDAsIDMpLCAyNDBdLCBbMjE5LCAyODJdKSxcbiAgICB9O1xuICAgIGNvbnN0IGxlZnRIYW5kID0ge1xuICAgICAgcG9zOiBbMCwgMF0sXG4gICAgICBzcHJpdGU6IG5ldyBTcHJpdGUob3JrU3ByaXRlTG9jYXRpb24sIFsxNjUgKiBGaWdodEludGVyZmFjZS5nZXRSYW5kb21JbnQoMCwgMyksIDcyMF0sIFsxNjUsIDIxMF0pLFxuICAgIH07XG4gICAgY29uc3QgaGVhZCA9IHtcbiAgICAgIHBvczogWzAsIDBdLFxuICAgICAgc3ByaXRlOiBuZXcgU3ByaXRlKG9ya1Nwcml0ZUxvY2F0aW9uLCBbMjIwICogRmlnaHRJbnRlcmZhY2UuZ2V0UmFuZG9tSW50KDAsIDMpLCA1MjVdLCBbMjIwLCAxOTVdKSxcbiAgICB9O1xuICAgIHJldHVybiBbcmlnaHRMZWcsIGxlZnRMZWcsIHJpZ2h0SGFuZCwgb3JrQm9keSwgaGVhZCwgbGVmdEhhbmRdO1xuICB9XG5cbiAgc3RhdGljIGdldFJhbmRvbUludChtaW4sIG1heCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSkgKyBtaW47XG4gIH1cblxuICBtYWtlU2hvdCgpIHtcbiAgICBjb25zdCB4ID0gdGhpcy5wbGF5ZXIucG9zWzBdICsgdGhpcy5wbGF5ZXIuc3ByaXRlLnNpemVbMF0gLyAyO1xuICAgIGNvbnN0IHkgPSB0aGlzLnBsYXllci5wb3NbMV07XG5cbiAgICB0aGlzLnBsYXllci5zcHJpdGUgPSBuZXcgU3ByaXRlKCdpbWcva25pZ2h0QXR0YWNrLnBuZycsIFswLCAwXSwgWzI1NiwgMjU2XSwgMTUsIFswLCAxLCAyLCAzLCA0LCA1XSk7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLnBsYXllci5zcHJpdGUgPSBuZXcgU3ByaXRlKCdpbWcva25pZ2h0LnBuZycsIFswLCAwXSwgWzI1NiwgMjU2XSwgMTAsIFswLCAxLCAyLCAzLCA0LCA1XSk7XG4gICAgICB0aGlzLmJ1bGxldHMucHVzaCh7XG4gICAgICAgIHBvczogW3gsIHldLFxuICAgICAgICBzcHJpdGU6IG5ldyBTcHJpdGUoJ2ltZy9maXJlLnBuZycsIFswLCAwXSwgWzI1NiwgMjU2XSwgMTAsIFswLCAxLCAyLCAzLCA0LCA1XSksXG4gICAgICB9KTtcbiAgICB9LCAzMDApO1xuICAgIG1ha2VBU291bmQoJy4uL2dhbWUvc291bmRzL2ljZWJhbGwud2F2Jyk7XG4gIH1cblxuICBhdHRhY2tIZXJvKCkge1xuICAgIHRoaXMuaGVyb0hlYWx0aCAtPSAyNTtcbiAgICBjb25zb2xlLmxvZyh0aGlzLmhlcm9IZWFsdGgpO1xuICAgIHRoaXMuaXNEYW1hZ2VkID0gdHJ1ZTtcbiAgICB0aGlzLnBsYXllci5zcHJpdGUgPSBuZXcgU3ByaXRlKCdpbWcvZGFtYWdlLnBuZycsIFswLCAwXSwgWzI1NiwgMjU2XSwgMTUsIFswLCAxLCAyLCAzLCA0LCA1XSk7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLnBsYXllci5zcHJpdGUgPSBuZXcgU3ByaXRlKCdpbWcva25pZ2h0LnBuZycsIFswLCAwXSwgWzI1NiwgMjU2XSwgMTAsIFswLCAxLCAyLCAzLCA0LCA1XSk7XG4gICAgICB0aGlzLmlzRGFtYWdlZCA9IGZhbHNlO1xuICAgIH0sIDMwMCk7XG4gICAgbWFrZUFTb3VuZCgnLi4vZ2FtZS9zb3VuZHMvcXVib2R1cC1CYW5nU2hvcnQub2dnJyk7XG4gIH1cblxuICBoZWFsSGVybygpIHtcbiAgICBpZiAodGhpcy5oZXJvSGVhbHRoICE9PSAxMDApIHtcbiAgICAgIHRoaXMuaGVyb0hlYWx0aCArPSAyNTtcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMuaGVyb0hlYWx0aCk7XG4gICAgfVxuICAgIHRoaXMuaXNIZWFsZWQgPSB0cnVlO1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5pc0hlYWxlZCA9IGZhbHNlO1xuICAgIH0sIDEwMDApO1xuICAgIG1ha2VBU291bmQoJy4uL2dhbWUvc291bmRzL2JsZXNzaW5nLm9nZycpO1xuICB9XG5cbiAgdXBkYXRlRW50aXRpZXMoZHQpIHtcbiAgICB0aGlzLnBsYXllci5zcHJpdGUudXBkYXRlKGR0KTtcblxuICAgIHRoaXMuZW5lbXkuZm9yRWFjaChhID0+IGEuc3ByaXRlLnVwZGF0ZShkdCkpO1xuXG4gICAgdGhpcy5oZWFsLnNwcml0ZS51cGRhdGUoZHQpO1xuICAgIHRoaXMuZGFtYWdlLnNwcml0ZS51cGRhdGUoZHQpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJ1bGxldHMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHRoaXMuYnVsbGV0c1tpXS5wb3NbMF0gKz0gdGhpcy5idWxsZXRTcGVlZCAqIGR0O1xuICAgICAgdGhpcy5idWxsZXRzW2ldLnNwcml0ZS51cGRhdGUoZHQpO1xuICAgICAgaWYgKHRoaXMuYnVsbGV0c1tpXS5wb3NbMF0gPj0gdGhpcy5lbmVteVsyXS5wb3NbMF0pIHtcbiAgICAgICAgdGhpcy5vcmtIZWFsdGggLT0gMjU7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMub3JrSGVhbHRoKTtcbiAgICAgICAgdGhpcy5idWxsZXRzLnNwbGljZShpLCAxKTtcbiAgICAgICAgaSAtPSAxO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXRoaXMuaGVyb0hlYWx0aCkge1xuICAgICAgYWxlcnQoJ0xvc2UnKTtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLm9ya0hlYWx0aCkge1xuICAgICAgYWxlcnQoJ1dpbicpO1xuICAgICAgdGhpcy5yZXNldCgpO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlckVudGl0eShlbnRpdHkpIHtcbiAgICB0aGlzLmN0eC5zYXZlKCk7XG4gICAgdGhpcy5jdHgudHJhbnNsYXRlKGVudGl0eS5wb3NbMF0sIGVudGl0eS5wb3NbMV0pO1xuICAgIGVudGl0eS5zcHJpdGUucmVuZGVyKHRoaXMuY3R4LCB0aGlzLnJlc291cmNlcyk7XG4gICAgdGhpcy5jdHgucmVzdG9yZSgpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHRoaXMuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcbiAgICB0aGlzLnJlbmRlckVudGl0eSh0aGlzLnBsYXllcik7XG4gICAgaWYgKHRoaXMuaXNEYW1hZ2VkKSB7XG4gICAgICB0aGlzLnJlbmRlckVudGl0eSh0aGlzLmRhbWFnZSk7XG4gICAgfVxuICAgIGlmICh0aGlzLmlzSGVhbGVkKSB7XG4gICAgICB0aGlzLnJlbmRlckVudGl0eSh0aGlzLmhlYWwpO1xuICAgIH1cbiAgICB0aGlzLnJlbmRlckVudGl0aWVzKHRoaXMuZW5lbXkpO1xuICAgIHRoaXMucmVuZGVyRW50aXRpZXModGhpcy5idWxsZXRzKTtcbiAgfVxuXG4gIHJlbmRlckVudGl0aWVzKGxpc3QpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHRoaXMucmVuZGVyRW50aXR5KGxpc3RbaV0pO1xuICAgIH1cbiAgfVxuXG4gIHJlc2V0KCkge1xuICAgIHRoaXMuaGVyb0hlYWx0aCA9IDEwMDtcbiAgICB0aGlzLm9ya0hlYWx0aCA9IDEwMDtcblxuICAgIHRoaXMuYnVsbGV0cyA9IFtdO1xuXG4gICAgdGhpcy5wbGF5ZXIucG9zID0gWzI1LCB0aGlzLmNhbnZhcy5oZWlnaHQgLyAyIC0gdGhpcy5wbGF5ZXIuc3ByaXRlLnNpemVbMF0gLyAyXTtcbiAgICB0aGlzLmRhbWFnZS5wb3MgPSBbMjUsIHRoaXMuY2FudmFzLmhlaWdodCAvIDIgLSB0aGlzLnBsYXllci5zcHJpdGUuc2l6ZVswXSAvIDJdO1xuICAgIHRoaXMuaGVhbC5wb3MgPSBbMjUsIHRoaXMuY2FudmFzLmhlaWdodCAvIDIgLSB0aGlzLnBsYXllci5zcHJpdGUuc2l6ZVswXSAvIDJdO1xuXG4gICAgdGhpcy5lbmVteS5zcGxpY2UoMCwgdGhpcy5lbmVteS5sZW5ndGgpO1xuICAgIHRoaXMuZW5lbXkucHVzaCguLi5GaWdodEludGVyZmFjZS5nZXRFbmVteVNwcml0ZXMoKSk7XG5cbiAgICBjb25zdCBib2R5U2l6ZVggPSB0aGlzLmVuZW15WzNdLnNwcml0ZS5zaXplWzBdO1xuICAgIGNvbnN0IGJvZHlTaXplWSA9IHRoaXMuZW5lbXlbM10uc3ByaXRlLnNpemVbMV07XG4gICAgY29uc3QgY2FudmFzV2lkdGggPSB0aGlzLmNhbnZhcy53aWR0aDtcbiAgICBjb25zdCBjYW52YXNIZWlnaHQgPSB0aGlzLmNhbnZhcy5oZWlnaHQ7XG5cbiAgICB0aGlzLmVuZW15WzNdLnBvcyA9IFtjYW52YXNXaWR0aCAtIGJvZHlTaXplWCAtIDIwMCwgY2FudmFzSGVpZ2h0IC8gMiAtIGJvZHlTaXplWSAvIDJdO1xuICAgIHRoaXMuZW5lbXlbMV0ucG9zID0gW2NhbnZhc1dpZHRoIC0gYm9keVNpemVYIC0gMTgwLCBjYW52YXNIZWlnaHQgLyAyIC0gYm9keVNpemVZIC8gMiArIDE4MF07XG4gICAgdGhpcy5lbmVteVswXS5wb3MgPSBbY2FudmFzV2lkdGggLSBib2R5U2l6ZVggLSA5MCwgY2FudmFzSGVpZ2h0IC8gMiAtIGJvZHlTaXplWSAvIDIgKyAxODBdO1xuICAgIHRoaXMuZW5lbXlbMl0ucG9zID0gW2NhbnZhc1dpZHRoIC0gYm9keVNpemVYIC0gMzYwLCBjYW52YXNIZWlnaHQgLyAyIC0gYm9keVNpemVZIC8gMiArIDIwXTtcbiAgICB0aGlzLmVuZW15WzVdLnBvcyA9IFtjYW52YXNXaWR0aCAtIGJvZHlTaXplWCAtIDQ1LCBjYW52YXNIZWlnaHQgLyAyIC0gYm9keVNpemVZIC8gMiArIDQwXTtcbiAgICB0aGlzLmVuZW15WzRdLnBvcyA9IFtjYW52YXNXaWR0aCAtIGJvZHlTaXplWCAtIDIxMCwgY2FudmFzSGVpZ2h0IC8gMiAtIGJvZHlTaXplWSAvIDIgLSA4MF07XG4gIH1cbn1cbiIsIlxuY29uc3QgcmVzb3VyY2VDYWNoZSA9IHt9O1xuY29uc3QgcmVhZHlDYWxsYmFja3MgPSBbXTtcblxuXG5mdW5jdGlvbiBpc1JlYWR5KCkge1xuICBsZXQgcmVhZHkgPSB0cnVlO1xuICBPYmplY3Qua2V5cyhyZXNvdXJjZUNhY2hlKS5mb3JFYWNoKChrKSA9PiB7XG4gICAgaWYgKHJlc291cmNlQ2FjaGUuaGFzT3duUHJvcGVydHkoaylcbiAgICAgICAgICAgICAgJiYgIXJlc291cmNlQ2FjaGVba10pIHtcbiAgICAgIHJlYWR5ID0gZmFsc2U7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHJlYWR5O1xufVxuXG5mdW5jdGlvbiBsb2FkVVJMKHVybCkge1xuICBpZiAocmVzb3VyY2VDYWNoZVt1cmxdKSB7XG4gICAgcmV0dXJuIHJlc291cmNlQ2FjaGVbdXJsXTtcbiAgfVxuXG4gIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpO1xuICBpbWcub25sb2FkID0gKCkgPT4ge1xuICAgIHJlc291cmNlQ2FjaGVbdXJsXSA9IGltZztcbiAgICBpZiAoaXNSZWFkeSgpKSB7XG4gICAgICByZWFkeUNhbGxiYWNrcy5mb3JFYWNoKChmdW5jKSA9PiB7IGZ1bmMoKTsgfSk7XG4gICAgfVxuICB9O1xuICByZXNvdXJjZUNhY2hlW3VybF0gPSBmYWxzZTtcbiAgaW1nLnNyYyA9IHVybDtcbn1cbi8vIExvYWQgYW4gaW1hZ2UgdXJsIG9yIGFuIGFycmF5IG9mIGltYWdlIHVybHNcbmZ1bmN0aW9uIGxvYWQodXJsT3JBcnIpIHtcbiAgaWYgKHVybE9yQXJyIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICB1cmxPckFyci5mb3JFYWNoKCh1cmwpID0+IHtcbiAgICAgIGxvYWRVUkwodXJsKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBsb2FkVVJMKHVybE9yQXJyKTtcbiAgfVxufVxuXG5cbmZ1bmN0aW9uIGdldCh1cmwpIHtcbiAgcmV0dXJuIHJlc291cmNlQ2FjaGVbdXJsXTtcbn1cblxuZnVuY3Rpb24gb25SZWFkeShmdW5jKSB7XG4gIHJlYWR5Q2FsbGJhY2tzLnB1c2goZnVuYyk7XG59XG5jb25zdCByZXNvdXJjZXMgPSB7XG4gIGxvYWQsXG4gIGdldCxcbiAgb25SZWFkeSxcbiAgaXNSZWFkeSxcbn07XG5leHBvcnQgZGVmYXVsdCByZXNvdXJjZXM7XG4iLCJpbXBvcnQgRmlnaHRJbnRlcmZhY2UgZnJvbSAnLi9maWdodEludGVyZmFjZSc7XG5pbXBvcnQgcmVzb3VyY2VIYW5kbGVyIGZyb20gJy4vcmVzb3VyY2VIYW5kbGVyJztcblxuY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG5jYW52YXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbmNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNhbnZhcyk7XG5cbmNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuY29uc3QgZ2FtZSA9IG5ldyBGaWdodEludGVyZmFjZShjYW52YXMsIGN0eCwgcmVzb3VyY2VIYW5kbGVyKTtcblxubGV0IGxhc3RUaW1lID0gMDtcbmZ1bmN0aW9uIG1haW4oKSB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IGR0ID0gKG5vdyAtIGxhc3RUaW1lKSAvIDEwMDAuMDtcbiAgZ2FtZS51cGRhdGVFbnRpdGllcyhkdCk7XG4gIGdhbWUucmVuZGVyKCk7XG4gIGxhc3RUaW1lID0gbm93O1xuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobWFpbik7XG59XG5mdW5jdGlvbiBpbml0KCkge1xuICBnYW1lLnJlc2V0KCk7XG4gIGxhc3RUaW1lID0gRGF0ZS5ub3coKTtcbiAgbWFpbigpO1xufVxuXG5yZXNvdXJjZUhhbmRsZXIubG9hZChbXG4gICdpbWcvaGVhbC5wbmcnLFxuICAnaW1nL2V4cGxvc2lvbi5wbmcnLFxuICAnaW1nL2RhbWFnZS5wbmcnLFxuICAnaW1nL2tuaWdodC5wbmcnLFxuICAnaW1nL2ZpcmUucG5nJyxcbiAgJ2ltZy9rbmlnaHRBdHRhY2sucG5nJyxcbiAgJ2ltZy9vcmtTcHJpdGUucG5nJyxcbl0pO1xucmVzb3VyY2VIYW5kbGVyLm9uUmVhZHkoaW5pdCk7XG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGdhbWUubWFrZVNob3QoKTtcbn0sIGZhbHNlKTtcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgZ2FtZS5hdHRhY2tIZXJvKCk7XG59LCBmYWxzZSk7XG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG4gIGlmIChlLmNvZGUgPT09ICdTcGFjZScpIHsgZ2FtZS5oZWFsSGVybygpOyB9XG59LCBmYWxzZSk7XG4iXSwic291cmNlUm9vdCI6IiJ9